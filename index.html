
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ù„Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª - Ø­Ø³Ø¨ Ø§Ù„Ø£Ø­Ù…Ø§Ù„ Ø§Ù„ØªØ²Ø§Ù…Ù†ÙŠØ©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .input-section {
            background: #f8f9ff;
            border: 2px solid #e3f2fd;
        }

        .results-section {
            background: #f1f8e9;
            border: 2px solid #c8e6c9;
            display: none;
        }

        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #4facfe;
            padding-bottom: 10px;
        }

        .form-group {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr auto;
            gap: 15px;
            align-items: end;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .form-group label {
            font-weight: bold;
            color: #555;
            margin-bottom: 5px;
            display: block;
        }

        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .form-group input::placeholder {
            color: #999;
            font-style: italic;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .btn-add {
            background: #4caf50;
            color: white;
        }

        .btn-add:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-remove {
            background: #f44336;
            color: white;
            padding: 8px 12px;
            font-size: 14px;
        }

        .btn-remove:hover {
            background: #da190b;
        }

        .btn-calculate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            margin: 20px auto;
            display: block;
            min-width: 200px;
        }

        .btn-calculate:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .btn-export {
            background: #ff9800;
            color: white;
            margin-left: 10px;
        }

        .btn-export:hover {
            background: #e68900;
        }

        .meters-list {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .meter-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: #f5f5f5;
            border-radius: 6px;
            border-right: 4px solid #4facfe;
        }

        .meter-info {
            flex-grow: 1;
        }

        .meter-info strong {
            color: #333;
            font-size: 16px;
        }

        .meter-details {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }

        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 6px;
            font-weight: bold;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4facfe;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .transformer-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #4facfe;
        }

        .breaker-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .breaker-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #4facfe;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 5px 0;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .progress-low { background: #4caf50; }
        .progress-medium { background: #ff9800; }
        .progress-high { background: #f44336; }
        .progress-overload { background: #ff5722; }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .results-table th {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
        }

        .results-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .results-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .results-table tr:hover {
            background: #e3f2fd;
            transition: background 0.3s;
        }

        .overloaded {
            background-color: #ff5722 !important;
            color: white !important;
            font-weight: bold;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-top: 4px solid #4facfe;
        }

        .summary-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .summary-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #4facfe;
        }

        .meter-details-cell {
            text-align: right !important;
            padding: 15px !important;
            line-height: 1.8;
        }

        .meter-detail-item {
            display: inline-block;
            background: #f0f8ff;
            border: 2px solid #4facfe;
            border-radius: 8px;
            padding: 8px 12px;
            margin: 3px;
            font-weight: bold;
            color: #2c5aa0;
            font-size: 14px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .form-group {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 15px;
            }
            
            .summary-grid {
                grid-template-columns: 1fr;
            }

            .breaker-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“‹ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ù„Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª</h1>
            <p>ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø­Ù…Ø§Ù„ Ø§Ù„ØªØ²Ø§Ù…Ù†ÙŠØ© - 248A Ø­Ø¯ Ø£Ù‚ØµÙ‰ Ù„ÙƒÙ„ Ù‚Ø§Ø·Ø¹</p>
        </div>

        <div class="content">
            <div class="section input-section">
                <h2>ğŸ“Š Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
                
                <div class="form-group">
                    <div>
                        <label for="meterType">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯:</label>
                        <select id="meterType">
                            <option value="C1">C1 - Ø³ÙƒÙ†ÙŠ Ø¹Ø§Ø¯ÙŠ (ÙÙ„Ù„ØŒ Ø´Ù‚Ù‚ØŒ Ø¯ÙˆØ¨Ù„ÙƒØ³...)</option>
                            <option value="C2">C2 - Ù…Ø­Ù„Ø§Øª ØªØ¬Ø§Ø±ÙŠØ©</option>
                            <option value="C3">C3 - Ø´Ù‚Ù‚ Ù…ÙØ±ÙˆØ´Ø© / Ø³ÙƒÙ† Ø¹Ù…Ø§Ù„</option>
                            <option value="C4">C4 - ÙÙ†Ø§Ø¯Ù‚</option>
                            <option value="C5">C5 - Ù…ÙˆÙ„Ø§Øª / Ù…Ø±Ø§ÙƒØ² ØªØ³ÙˆÙ‚</option>
                            <option value="C6">C6 - Ù…Ø·Ø§Ø¹Ù… / Ù…Ù‚Ø§Ù‡ÙŠ</option>
                            <option value="C7">C7 - Ù…ÙƒØ§ØªØ¨ (Ø­ÙƒÙˆÙ…ÙŠØ©/ØªØ¬Ø§Ø±ÙŠØ©)</option>
                            <option value="C8">C8 - Ù…Ø¯Ø§Ø±Ø³ / Ø­Ø¶Ø§Ù†Ø§Øª</option>
                            <option value="C9">C9 - Ù…Ø³Ø§Ø¬Ø¯</option>
                            <option value="C10">C10 - Ù…ÙŠØ²Ø§Ù†ÙŠÙ† ÙÙ†Ø¯Ù‚</option>
                            <option value="C11">C11 - Ø®Ø¯Ù…Ø§Øª Ù…Ø´ØªØ±ÙƒØ© ÙÙŠ Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ</option>
                            <option value="C12">C12 - Ù…Ø±Ø§ÙÙ‚ Ø¹Ø§Ù…Ø© (Ø­Ù…Ø§Ù…Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ© ÙˆØºÙŠØ±Ù‡Ø§)</option>
                            <option value="C13">C13 - Ù…ÙˆØ§Ù‚Ù Ø³ÙŠØ§Ø±Ø§Øª Ø¯Ø§Ø®Ù„ÙŠØ©</option>
                            <option value="C14">C14 - Ù…ÙˆØ§Ù‚Ù Ø®Ø§Ø±Ø¬ÙŠØ©</option>
                            <option value="C15">C15 - Ø¥Ù†Ø§Ø±Ø© Ø´ÙˆØ§Ø±Ø¹</option>
                            <option value="C16">C16 - Ø­Ø¯Ø§Ø¦Ù‚ ÙˆÙ…ØªÙ†Ø²Ù‡Ø§Øª</option>
                            <option value="C17">C17 - Ø³Ø§Ø­Ø§Øª Ù…ÙØªÙˆØ­Ø©</option>
                            <option value="C18">C18 - Ù…Ø³ØªØ´ÙÙŠØ§Øª / Ù…Ø±Ø§ÙÙ‚ Ø·Ø¨ÙŠØ©</option>
                            <option value="C19">C19 - Ø¹ÙŠØ§Ø¯Ø§Øª Ø·Ø¨ÙŠØ©</option>
                            <option value="C20">C20 - Ø¬Ø§Ù…Ø¹Ø§Øª / Ù…Ø¹Ø§Ù‡Ø¯ Ø¹Ù„ÙŠØ§</option>
                            <option value="C21">C21 - ØµÙ†Ø§Ø¹Ø§Øª Ø®ÙÙŠÙØ©</option>
                            <option value="C22">C22 - ÙˆØ±Ø´ Ø¹Ù…Ù„</option>
                            <option value="C23">C23 - Ù…Ø®Ø§Ø²Ù† ØªØ¨Ø±ÙŠØ¯</option>
                            <option value="C24">C24 - Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª</option>
                            <option value="C25">C25 - Ù‚Ø§Ø¹Ø§Øª Ù…Ù†Ø§Ø³Ø¨Ø§Øª</option>
                            <option value="C26">C26 - Ù…Ù†Ø´Ø¢Øª ØªØ±ÙÙŠÙ‡ÙŠØ©</option>
                            <option value="C27">C27 - Ù…Ø²Ø§Ø±Ø¹ / Ù…Ù†Ø´Ø¢Øª Ø²Ø±Ø§Ø¹ÙŠØ©</option>
                            <option value="C28">C28 - Ù…Ø­Ø·Ø§Øª ÙˆÙ‚ÙˆØ¯</option>
                            <option value="C29">C29 - Ù…ØµØ§Ù†Ø¹ ÙƒØ¨Ø±Ù‰</option>
                        </select>
                    </div>
                    <div>
                        <label for="meterCount">Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª:</label>
                        <input type="number" id="meterCount" min="1" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª">
                    </div>
                    <div>
                        <label for="meterCapacity">Ø³Ø¹Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯ (A):</label>
                        <select id="meterCapacity">
                            <option value="20">20A</option>
                            <option value="30">30A</option>
                            <option value="40">40A</option>
                            <option value="50">50A</option>
                            <option value="70">70A</option>
                            <option value="100">100A</option>
                            <option value="125">125A</option>
                            <option value="150">150A</option>
                            <option value="200">200A</option>
                            <option value="250">250A</option>
                            <option value="300">300A</option>
                            <option value="400">400A</option>
                            <option value="500">500A</option>
                            <option value="800">800A</option>
                        </select>
                    </div>
                    <div>
                        <button class="btn btn-add" onclick="addMeter()">â• Ø¥Ø¶Ø§ÙØ©</button>
                    </div>
                </div>

                <div class="meters-list" id="metersList">
                    <h3>ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©:</h3>
                    <div id="metersContainer"></div>
                </div>

                <button class="btn btn-export" onclick="addSampleData()" style="margin: 10px;">ğŸ¯ Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
                
                <button class="btn btn-calculate" onclick="calculateSequentialDistribution()">
                    ğŸ“‹ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ
                </button>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø­Ù…Ø§Ù„ Ø§Ù„ØªØ²Ø§Ù…Ù†ÙŠØ©...</p>
                </div>
            </div>

            <div class="section results-section" id="resultsSection">
                <h2>ğŸ“ˆ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ</h2>
                
                <div class="summary-card">
                    <div class="summary-grid" id="summaryGrid"></div>
                </div>
                
                <div id="transformersSection"></div>
                
                <table class="results-table" id="resultsTable">
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ù…Ø­ÙˆÙ„</th>
                            <th>Ø±Ù‚Ù… Ø§Ù„Ù‚Ø§Ø·Ø¹</th>
                            <th>Ù†ÙˆØ¹ Ø§Ù„Ø£Ø­Ù…Ø§Ù„</th>
                            <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª</th>
                            <th>Ø§Ù„Ø­Ù…Ù„ Ø§Ù„ØªØ²Ø§Ù…Ù†ÙŠ (A)</th>
                            <th>Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody"></tbody>
                </table>

                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn btn-export" onclick="exportToExcel()">ğŸ“Š ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel</button>
                    <button class="btn btn-export" onclick="printResults()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ø«ÙˆØ§Ø¨Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø¯Ø«Ø© Ù„Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ
        const MAX_BREAKER_CAPACITY = 248; // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„ÙƒÙ„ Ù‚Ø§Ø·Ø¹
        
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©
        const TRANSFORMER_TYPES = [
            { 
                capacity: 500, 
                maxCurrent: 721, 
                safeMaxCurrent: 577,
                breakers: 4, 
                name: '500 KVA'
            },
            { 
                capacity: 1000, 
                maxCurrent: 1443, 
                safeMaxCurrent: 1154,
                breakers: 8, 
                name: '1000 KVA'
            },
            { 
                capacity: 1500, 
                maxCurrent: 2164, 
                safeMaxCurrent: 1731,
                breakers: 10, 
                name: '1500 KVA'
            }
        ];

        const meterTypeNames = {
            'C1': 'Ø³ÙƒÙ†ÙŠ Ø¹Ø§Ø¯ÙŠ', 'C2': 'Ù…Ø­Ù„Ø§Øª ØªØ¬Ø§Ø±ÙŠØ©', 'C3': 'Ø´Ù‚Ù‚ Ù…ÙØ±ÙˆØ´Ø©', 
            'C4': 'ÙÙ†Ø§Ø¯Ù‚', 'C5': 'Ù…ÙˆÙ„Ø§Øª', 'C6': 'Ù…Ø·Ø§Ø¹Ù…', 'C7': 'Ù…ÙƒØ§ØªØ¨', 
            'C8': 'Ù…Ø¯Ø§Ø±Ø³', 'C9': 'Ù…Ø³Ø§Ø¬Ø¯', 'C10': 'Ù…ÙŠØ²Ø§Ù†ÙŠÙ† ÙÙ†Ø¯Ù‚',
            'C11': 'Ø®Ø¯Ù…Ø§Øª Ù…Ø´ØªØ±ÙƒØ©', 'C12': 'Ù…Ø±Ø§ÙÙ‚ Ø¹Ø§Ù…Ø©', 'C13': 'Ù…ÙˆØ§Ù‚Ù Ø¯Ø§Ø®Ù„ÙŠØ©',
            'C14': 'Ù…ÙˆØ§Ù‚Ù Ø®Ø§Ø±Ø¬ÙŠØ©', 'C15': 'Ø¥Ù†Ø§Ø±Ø© Ø´ÙˆØ§Ø±Ø¹', 'C16': 'Ø­Ø¯Ø§Ø¦Ù‚',
            'C17': 'Ø³Ø§Ø­Ø§Øª Ù…ÙØªÙˆØ­Ø©', 'C18': 'Ù…Ø³ØªØ´ÙÙŠØ§Øª', 'C19': 'Ø¹ÙŠØ§Ø¯Ø§Øª',
            'C20': 'Ø¬Ø§Ù…Ø¹Ø§Øª', 'C21': 'ØµÙ†Ø§Ø¹Ø§Øª Ø®ÙÙŠÙØ©', 'C22': 'ÙˆØ±Ø´ Ø¹Ù…Ù„',
            'C23': 'Ù…Ø®Ø§Ø²Ù† ØªØ¨Ø±ÙŠØ¯', 'C24': 'Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª', 'C25': 'Ù‚Ø§Ø¹Ø§Øª Ù…Ù†Ø§Ø³Ø¨Ø§Øª',
            'C26': 'Ù…Ù†Ø´Ø¢Øª ØªØ±ÙÙŠÙ‡ÙŠØ©', 'C27': 'Ù…Ø²Ø§Ø±Ø¹', 'C28': 'Ù…Ø­Ø·Ø§Øª ÙˆÙ‚ÙˆØ¯',
            'C29': 'Ù…ØµØ§Ù†Ø¹ ÙƒØ¨Ø±Ù‰'
        };

        const demandFactors = {
            'C1': 0.5, 'C2': 0.6, 'C3': 0.55, 'C4': 0.7, 'C5': 0.8, 
            'C6': 0.75, 'C7': 0.65, 'C8': 0.6, 'C9': 0.4, 'C10': 0.65,
            'C11': 0.7, 'C12': 0.5, 'C13': 0.3, 'C14': 0.25, 'C15': 0.9,
            'C16': 0.4, 'C17': 0.35, 'C18': 0.8, 'C19': 0.7, 'C20': 0.65,
            'C21': 0.75, 'C22': 0.7, 'C23': 0.85, 'C24': 0.6, 'C25': 0.8,
            'C26': 0.75, 'C27': 0.6, 'C28': 0.9, 'C29': 0.85
        };

        let meters = [];
        let distributionResults = null;

        // Ø­Ø³Ø§Ø¨ Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ²Ø§Ù…Ù†
        function calculateCoincidenceFactor(N, meterType) {
            if (meterType === 'C2' || meterType === 'C15' || meterType === 'C28') return 1;
            if (N === 1) return 1;
            const sqrtN = Math.sqrt(N);
            return (0.67 + (0.33 / sqrtN)) / 1.25;
        }

        /**
         * ØªØ­ÙˆÙŠÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ù„Ù‰ Ø¹Ø¯Ø§Ø¯Ø§Øª ÙØ±Ø¯ÙŠØ©
         */
        function convertToIndividualMeters(meterGroups) {
            const individualMeters = [];
            
            meterGroups.forEach(meterGroup => {
                const cdlPerMeter = meterGroup.totalCDL / meterGroup.count;
                
                for (let i = 0; i < meterGroup.count; i++) {
                    individualMeters.push({
                        id: `${meterGroup.id}_${i + 1}`,
                        type: meterGroup.type,
                        typeName: meterGroup.typeName,
                        capacity: meterGroup.capacity,
                        cdl: cdlPerMeter,
                        meterNumber: i + 1,
                        groupId: meterGroup.id,
                        demandFactor: meterGroup.demandFactor,
                        coincidenceFactor: meterGroup.coincidenceFactor
                    });
                }
            });
            
            return individualMeters;
        }

        /**
         * Ø¥Ù†Ø´Ø§Ø¡ Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø­ÙˆÙ„
         */
        function createBreakers(breakerCount, maxCapacity) {
            const breakers = [];
            
            for (let i = 1; i <= breakerCount; i++) {
                breakers.push({
                    id: i,
                    number: i,
                    maxCapacity: maxCapacity,
                    currentLoad: 0,
                    meters: [],
                    meterTypes: new Set(),
                    utilizationPercent: 0,
                    status: 'available',
                    remainingCapacity: maxCapacity
                });
            }
            
            return breakers;
        }

        /**
         * Ø¥Ø¶Ø§ÙØ© Ø¹Ø¯Ø§Ø¯ Ù„Ù‚Ø§Ø·Ø¹ Ù…Ø¹ÙŠÙ†
         */
        function addMeterToBreaker(breaker, meter) {
            breaker.meters.push(meter);
            breaker.currentLoad += meter.cdl;
            breaker.meterTypes.add(meter.type);
            breaker.utilizationPercent = (breaker.currentLoad / breaker.maxCapacity) * 100;
            breaker.remainingCapacity = breaker.maxCapacity - breaker.currentLoad;
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù‚Ø§Ø·Ø¹
            if (breaker.currentLoad > breaker.maxCapacity) {
                breaker.status = 'overloaded';
            } else if (breaker.utilizationPercent >= 90) {
                breaker.status = 'near_full';
            } else {
                breaker.status = 'in_use';
            }
        }

        /**
         * Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ù…Ø­ÙˆÙ„
         */
        function calculateTransformerCurrentLoad(transformer) {
            return transformer.breakers.reduce((sum, breaker) => sum + breaker.currentLoad, 0);
        }

function canTransformerAcceptMeter(transformer, meterCDL) {
    // Ø£ÙˆÙ„Ø§Ù‹: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù‚Ø§Ø·Ø¹ Ù…ØªØ§Ø­ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„Ø¹Ø¯Ø§Ø¯
    const availableBreaker = transformer.breakers.find(breaker => 
        breaker.remainingCapacity >= meterCDL
    );
    
    if (!availableBreaker) {
        console.log(`Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ù…Ù…ØªÙ„Ø¦Ø© ÙÙŠ Ø§Ù„Ù…Ø­ÙˆÙ„ ${transformer.id} - Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø¹Ø¯Ø§Ø¯ Ø¨Ø­Ù…Ù„ ${meterCDL.toFixed(1)}A`);
        return false;
    }
    
    // Ø«Ø§Ù†ÙŠØ§Ù‹: Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø§Ù„ÙØ¹Ù„ÙŠ Ù„Ù„Ù…Ø­ÙˆÙ„
    const currentTotalLoad = calculateTransformerCurrentLoad(transformer);
    const newTotalLoad = currentTotalLoad + meterCDL;
    const wouldExceedSafeLimit = newTotalLoad > transformer.type.safeMaxCurrent;
    
    if (wouldExceedSafeLimit) {
        console.log(`âŒ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø³ØªØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø¢Ù…Ù† (80%) Ù„Ù„Ù…Ø­ÙˆÙ„ ${transformer.id}`);
        console.log(`   Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${currentTotalLoad.toFixed(1)}A`);
        console.log(`   Ø­Ù…Ù„ Ø§Ù„Ø¹Ø¯Ø§Ø¯: ${meterCDL.toFixed(1)}A`);
        console.log(`   Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: ${newTotalLoad.toFixed(1)}A`);
        console.log(`   Ø§Ù„Ø­Ø¯ Ø§Ù„Ø¢Ù…Ù†: ${transformer.type.safeMaxCurrent.toFixed(1)}A`);
        return false;
    }
    
    console.log(`âœ… ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ù„Ù„Ù…Ø­ÙˆÙ„ ${transformer.id}`);
    console.log(`   Ø§Ù„Ø­Ù…Ù„ Ø³ÙŠØµØ¨Ø­: ${newTotalLoad.toFixed(1)}A / ${transformer.type.safeMaxCurrent.toFixed(1)}A (${((newTotalLoad/transformer.type.safeMaxCurrent)*100).toFixed(1)}%)`);
    return true;
}

     

        

        /**
         * Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙØ¶Ù„ Ù‚Ø§Ø·Ø¹ Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯
         */
        function findBestBreakerForMeter(transformer, meter) {
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù‚Ø§Ø·Ø¹ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„Ø¹Ø¯Ø§Ø¯
            const availableBreakers = transformer.breakers.filter(breaker => 
                breaker.remainingCapacity >= meter.cdl
            );
            
            if (availableBreakers.length === 0) {
                return null; // Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù‚Ø§Ø·Ø¹ Ù…ØªØ§Ø­
            }
            
            // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø§Ø·Ø¹ Ø§Ù„Ø£Ù‚Ù„ Ø­Ù…Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…ØªØ§Ø­Ø©
            return availableBreakers.reduce((best, current) => 
                current.currentLoad > best.currentLoad ? current : best
            );
        }

        /**
         * ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù„Ù‰ Ù…Ø­ÙˆÙ„ ÙˆØ§Ø­Ø¯ - Ù…Ø­Ø³Ù†
         */
        function distributeMetersOnSingleTransformer(individualMeters, transformer) {
            let totalLoad = 0;
            let distributedMeters = [];
            let remainingMeters = [...individualMeters];
            
            console.log(`Ø¨Ø¯Ø¡ ØªÙˆØ²ÙŠØ¹ ${individualMeters.length} Ø¹Ø¯Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­ÙˆÙ„ ${transformer.id} (${transformer.type.name})`);
            
            for (let i = 0; i < individualMeters.length; i++) {
                const meter = individualMeters[i];
                                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ù„Ù„Ù…Ø­ÙˆÙ„
                if (!canTransformerAcceptMeter(transformer, meter.cdl)) {
                    console.log(`Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¯Ø§Ø¯ ${meter.id} Ù„Ù„Ù…Ø­ÙˆÙ„ ${transformer.id} - Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ÙˆÙ„ Ø¬Ø¯ÙŠØ¯`);
                    break; // ØªÙˆÙ‚Ù Ø¹Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ÙˆÙ„
                }
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙØ¶Ù„ Ù‚Ø§Ø·Ø¹ Ù„Ù„Ø¹Ø¯Ø§Ø¯
                const bestBreaker = findBestBreakerForMeter(transformer, meter);
                
                if (bestBreaker) {
                    addMeterToBreaker(bestBreaker, meter);
                    totalLoad += meter.cdl;
                    distributedMeters.push(meter);
                    
                    console.log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¯Ø§Ø¯ ${meter.id} (${meter.cdl.toFixed(1)}A) Ù„Ù„Ù‚Ø§Ø·Ø¹ ${bestBreaker.number} ÙÙŠ Ø§Ù„Ù…Ø­ÙˆÙ„ ${transformer.id}`);
                } else {
                    console.log(`Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù‚Ø§Ø·Ø¹ Ù…ØªØ§Ø­ Ù„Ù„Ø¹Ø¯Ø§Ø¯ ${meter.id} ÙÙŠ Ø§Ù„Ù…Ø­ÙˆÙ„ ${transformer.id}`);
                    break; // ØªÙˆÙ‚Ù Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ù‚Ø§Ø·Ø¹ Ù…ØªØ§Ø­
                }
            }
            
            // Ø­Ø³Ø§Ø¨ Ù†Ø³Ø¨ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
            transformer.totalLoad = totalLoad;
            transformer.utilizationPercent = (totalLoad / transformer.type.safeMaxCurrent) * 100;
            transformer.actualUtilizationPercent = (totalLoad / transformer.type.maxCurrent) * 100;
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯
            transformer.overloadedBreakers = transformer.breakers.filter(b => b.utilizationPercent > 100).length;
            
            console.log(`Ø§Ù„Ù…Ø­ÙˆÙ„ ${transformer.id}: ØªÙ… ØªÙˆØ²ÙŠØ¹ ${distributedMeters.length} Ø¹Ø¯Ø§Ø¯ØŒ Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${totalLoad.toFixed(1)}A`);
            
            return {
                distributedMeters: distributedMeters,
                remainingMeters: remainingMeters.slice(distributedMeters.length),
                totalLoad: totalLoad
            };
        }

        /**
         * Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø­Ø³Ø¨ Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
         */
        function selectOptimalTransformerType(remainingLoad) {
            // Ø§Ø®ØªÙŠØ§Ø± Ø£ØµØºØ± Ù…Ø­ÙˆÙ„ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
            for (let transformerType of TRANSFORMER_TYPES) {
                if (remainingLoad <= transformerType.safeMaxCurrent * 0.85) { // Ù‡Ø§Ù…Ø´ Ø£Ù…Ø§Ù† 15%
                    console.log(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙˆÙ„ ${transformerType.name} Ù„Ù„Ø­Ù…Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ${remainingLoad.toFixed(1)}A`);
                    return transformerType;
                }
            }
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø­Ù…Ù„ ÙƒØ¨ÙŠØ±Ø§Ù‹ Ø¬Ø¯Ø§Ù‹ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø£ÙƒØ¨Ø± Ù…Ø­ÙˆÙ„
            console.log(`Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ${remainingLoad.toFixed(1)}A ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙƒØ¨Ø± Ù…Ø­ÙˆÙ„ Ù…ØªØ§Ø­`);
            return TRANSFORMER_TYPES[TRANSFORMER_TYPES.length - 1];
        }

        /**
         * Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ - Ù…Ø­Ø³Ù†Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
         */
        function performSequentialDistribution() {
            console.log('=== Ø¨Ø¯Ø¡ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø§Ù„Ù…Ø­Ø³Ù† ===');
            
            // ØªØ­ÙˆÙŠÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ù„Ù‰ Ø¹Ø¯Ø§Ø¯Ø§Øª ÙØ±Ø¯ÙŠØ©
            const individualMeters = convertToIndividualMeters(meters);
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ù…Ù„ (Ø§Ù„Ø£ÙƒØ¨Ø± Ø£ÙˆÙ„Ø§Ù‹)
            individualMeters.sort((a, b) => b.cdl - a.cdl);
            
            console.log(`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙØ±Ø¯ÙŠØ©: ${individualMeters.length}`);
            console.log(`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ù…Ù„: ${individualMeters.reduce((sum, m) => sum + m.cdl, 0).toFixed(1)}A`);
            
            const transformers = [];
            let remainingMeters = [...individualMeters];
            let transformerIndex = 1;
            
            while (remainingMeters.length > 0) {
                console.log(`\n--- Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­ÙˆÙ„ ${transformerIndex} ---`);
                console.log(`Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${remainingMeters.length}`);
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
                const remainingLoad = remainingMeters.reduce((sum, meter) => sum + meter.cdl, 0);
                console.log(`Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${remainingLoad.toFixed(1)}A`);
                
                // Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
                const transformerType = selectOptimalTransformerType(remainingLoad);
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ÙˆÙ„ Ø¬Ø¯ÙŠØ¯
                const transformer = {
                    id: transformerIndex,
                    type: transformerType,
                    totalLoad: 0,
                    utilizationPercent: 0,
                    actualUtilizationPercent: 0,
                    breakers: createBreakers(transformerType.breakers, MAX_BREAKER_CAPACITY),
                    overloadedBreakers: 0
                };
                
                // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ÙˆÙ„
                const distributionResult = distributeMetersOnSingleTransformer(remainingMeters, transformer);
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­ÙˆÙ„ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
                transformers.push(transformer);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©
                remainingMeters = distributionResult.remainingMeters;
                
                console.log(`Ø§Ù„Ù…Ø­ÙˆÙ„ ${transformerIndex} - Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${transformer.totalLoad.toFixed(1)}A / ${transformer.type.safeMaxCurrent}A`);
                console.log(`Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¢Ù…Ù†Ø©: ${transformer.utilizationPercent.toFixed(1)}%`);
                
                transformerIndex++;
                
                // Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠØ©
                if (transformerIndex > 50) {
                    console.error('ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù…Ù† Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª - ØªÙˆÙ‚Ù Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠØ©');
                    
                    // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ØŒ Ø£Ø¶Ù Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø£Ø®ÙŠØ± Ø¨Ø§Ù„Ù‚ÙˆØ©
                    if (remainingMeters.length > 0) {
                        const lastTransformer = transformers[transformers.length - 1];
                        console.warn(`Ø¥Ø¶Ø§ÙØ© ${remainingMeters.length} Ø¹Ø¯Ø§Ø¯ Ù…ØªØ¨Ù‚ÙŠ Ø¨Ø§Ù„Ù‚ÙˆØ© Ù„Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø£Ø®ÙŠØ±`);
                        
                        remainingMeters.forEach(meter => {
                            const leastLoadedBreaker = lastTransformer.breakers.reduce((min, breaker) => 
                                breaker.currentLoad < min.currentLoad ? breaker : min
                            );
                            addMeterToBreaker(leastLoadedBreaker, meter);
                            lastTransformer.totalLoad += meter.cdl;
                        });
                        
                        // Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ù†Ø³Ø¨ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
                        lastTransformer.utilizationPercent = (lastTransformer.totalLoad / lastTransformer.type.safeMaxCurrent) * 100;
                        lastTransformer.actualUtilizationPercent = (lastTransformer.totalLoad / lastTransformer.type.maxCurrent) * 100;
                        lastTransformer.overloadedBreakers = lastTransformer.breakers.filter(b => b.utilizationPercent > 100).length;
                        
                        remainingMeters = [];
                    }
                    break;
                }
            }
            
            console.log(`\n=== Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØªÙˆØ²ÙŠØ¹ ===`);
            console.log(`Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${transformers.length}`);
            
            const totalLoad = transformers.reduce((sum, t) => sum + t.totalLoad, 0);
            const summary = calculateSequentialSummary(transformers, totalLoad);
            
            return {
                totalLoad: totalLoad,
                transformers: transformers,
                summary: summary
            };
        }

        function addMeter() {
            const type = document.getElementById('meterType').value;
            const count = parseInt(document.getElementById('meterCount').value);
            const capacity = parseInt(document.getElementById('meterCapacity').value);

            if (!count || count <= 0) {
                showError('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª');
                return;
            }

            const demandFactor = demandFactors[type];
            const coincidenceFactor = calculateCoincidenceFactor(count, type);
            const cdlPerMeter = capacity * demandFactor;
            const totalCDL = count * cdlPerMeter * coincidenceFactor;

            const meterGroup = {
                id: Date.now(),
                type: type,
                typeName: meterTypeNames[type],
                count: count,
                capacity: capacity,
                demandFactor: demandFactor,
                coincidenceFactor: coincidenceFactor,
                cdlPerMeter: cdlPerMeter,
                totalCDL: totalCDL
            };

            meters.push(meterGroup);
            updateMetersList();
            clearInputs();
            showSuccess('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­');
        }

        function updateMetersList() {
            const container = document.getElementById('metersContainer');
            
            if (meters.length === 0) {
                container.innerHTML = '<p style="color: #666; text-align: center; padding: 20px;">Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ø¹Ø¯</p>';
                return;
            }

            container.innerHTML = meters.map(meter => `
                <div class="meter-item">
                    <div class="meter-info">
                        <strong>${meter.count} Ã— ${meter.typeName} (${meter.capacity}A)</strong>
                        <div class="meter-details">
                            Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ø·Ù„Ø¨: ${meter.demandFactor.toFixed(3)} | 
                            Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ²Ø§Ù…Ù†: ${meter.coincidenceFactor.toFixed(3)} | 
                            Ø§Ù„Ø­Ù…Ù„ Ø§Ù„ØªØ²Ø§Ù…Ù†ÙŠ: ${meter.totalCDL.toFixed(1)}A
                        </div>
                    </div>
                    <button class="btn btn-remove" onclick="removeMeter(${meter.id})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                </div>
            `).join('');
        }

        function removeMeter(id) {
            meters = meters.filter(meter => meter.id !== id);
            updateMetersList();
            showSuccess('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ø¯Ø§Ø¯');
        }

        function clearInputs() {
            document.getElementById('meterCount').value = '';
        }

        function addSampleData() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©ØŸ')) {
                meters = [];
                
                const sampleData = [
                    { type: 'C1', count: 50, capacity: 30 },
                    { type: 'C2', count: 40, capacity: 70 },
                    { type: 'C1', count: 45, capacity: 50 },
                    { type: 'C6', count: 25, capacity: 100 },
                    { type: 'C3', count: 35, capacity: 40 },
                    { type: 'C7', count: 30, capacity: 50 },
                    { type: 'C15', count: 20, capacity: 30 },
                    { type: 'C4', count: 22, capacity: 125 },
                    { type: 'C1', count: 60, capacity: 40 },
                    { type: 'C2', count: 35, capacity: 100 }
                ];

                sampleData.forEach(data => {
                    const demandFactor = demandFactors[data.type];
                    const coincidenceFactor = calculateCoincidenceFactor(data.count, data.type);
                    const cdlPerMeter = data.capacity * demandFactor;
                    const totalCDL = data.count * cdlPerMeter * coincidenceFactor;

                    meters.push({
                        id: Date.now() + Math.random(),
                        type: data.type,
                        typeName: meterTypeNames[data.type],
                        count: data.count,
                        capacity: data.capacity,
                        demandFactor: demandFactor,
                        coincidenceFactor: coincidenceFactor,
                        cdlPerMeter: cdlPerMeter,
                        totalCDL: totalCDL
                    });
                });

                updateMetersList();
                showSuccess('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© (Ø­Ù…Ù„ Ø¹Ø§Ù„ÙŠ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ÙˆÙ„Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©)');
            }
        }

        // Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ
        function calculateSequentialDistribution() {
            if (meters.length === 0) {
                showError('ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            document.getElementById('loading').style.display = 'block';
            
            setTimeout(() => {
                try {
                    const results = performSequentialDistribution();
                    displayResults(results);
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('resultsSection').style.display = 'block';
                    
                    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ù…Ø¹ ØªÙØ§ØµÙŠÙ„
                    const overloadedTransformers = results.transformers.filter(t => t.utilizationPercent > 100).length;
                    const warningMessage = overloadedTransformers > 0 
                        ? ` ØªØ­Ø°ÙŠØ±: ${overloadedTransformers} Ù…Ø­ÙˆÙ„ Ù…Ø­Ù…Ù„ Ø²Ø§Ø¦Ø¯!` 
                        : '';
                    
                    showSuccess(`ØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ! Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª: ${results.transformers.length}${warningMessage}`);
                } catch (error) {
                    document.getElementById('loading').style.display = 'none';
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:', error);
                    showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª: ' + error.message);
                }
            }, 1500);
        }

        function calculateSequentialSummary(transformers, totalLoad) {
            let totalBreakers = 0;
            let usedBreakers = 0;
            let totalMeters = 0;
            let overloadedBreakers = 0;
            let overloadedTransformers = 0;
            let maxBreakerUtilization = 0;
            let minBreakerUtilization = 100;
            let totalBreakerUtilization = 0;
            let utilizationCount = 0;

            transformers.forEach(transformer => {
                totalBreakers += transformer.type.breakers;
                
                transformer.breakers.forEach(breaker => {
                    if (breaker.meters.length > 0) {
                        usedBreakers++;
                        totalMeters += breaker.meters.length;
                        
                        if (breaker.utilizationPercent > 100) {
                            overloadedBreakers++;
                        }
                        
                        maxBreakerUtilization = Math.max(maxBreakerUtilization, breaker.utilizationPercent);
                        if (breaker.utilizationPercent > 0) {
                            minBreakerUtilization = Math.min(minBreakerUtilization, breaker.utilizationPercent);
                        }
                        totalBreakerUtilization += breaker.utilizationPercent;
                        utilizationCount++;
                    }
                });

                if (transformer.utilizationPercent > 100) {
                    overloadedTransformers++;
                }
            });

            const avgBreakerUtilization = utilizationCount > 0 ? totalBreakerUtilization / utilizationCount : 0;
            const efficiency = totalBreakers > 0 ? (usedBreakers / totalBreakers) * 100 : 0;

            return {
                totalTransformers: transformers.length,
                totalBreakers,
                usedBreakers,
                totalMeters,
                totalLoad: totalLoad.toFixed(1),
                overloadedBreakers,
                overloadedTransformers,
                maxBreakerUtilization: maxBreakerUtilization.toFixed(1),
                minBreakerUtilization: minBreakerUtilization === 100 ? '0.0' : minBreakerUtilization.toFixed(1),
                avgBreakerUtilization: avgBreakerUtilization.toFixed(1),
                efficiency: efficiency.toFixed(1)
            };
        }

        function displayResults(results) {
            distributionResults = results;
            
            displaySummary(results.summary);
            displayTransformers(results.transformers);
            displayResultsTable(results.transformers);
        }

        function displaySummary(summary) {
            const summaryGrid = document.getElementById('summaryGrid');
            
            const totalLoadKVA = (summary.totalLoad * 0.4 * 1.73).toFixed(1);
            
            summaryGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${summary.totalTransformers}</div>
                    <div>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.usedBreakers}</div>
                    <div>Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.totalMeters}</div>
                    <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.totalLoad}</div>
                    <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ù…Ù„ (Ø£Ù…Ø¨ÙŠØ±)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${totalLoadKVA}</div>
                    <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ù…Ù„ (KVA)</div>
                </div>
                <div class="stat-card ${summary.overloadedTransformers > 0 ? 'overloaded' : ''}">
                    <div class="stat-number">${summary.overloadedTransformers}</div>
                    <div>Ù…Ø­ÙˆÙ„Ø§Øª Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯</div>
                </div>
                <div class="stat-card ${summary.overloadedBreakers > 0 ? 'overloaded' : ''}">
                    <div class="stat-number">${summary.overloadedBreakers}</div>
                    <div>Ù‚ÙˆØ§Ø·Ø¹ Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.efficiency}%</div>
                    <div>ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</div>
                </div>
            `;
        }

        function displayTransformers(transformers) {
            const transformersSection = document.getElementById('transformersSection');
            
            transformersSection.innerHTML = transformers.map((transformer, index) => {
                const usedBreakers = transformer.breakers.filter(b => b.meters.length > 0);
                const transformerStatus = getTransformerStatus(transformer.utilizationPercent);
                
                return `
                    <div class="transformer-section">
                        <h3>ğŸ”Œ Ø§Ù„Ù…Ø­ÙˆÙ„ ${index + 1}: ${transformer.type.name} ${transformerStatus}</h3>
                        <div style="margin-bottom: 15px;">
                            <strong>Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</strong> ${transformer.totalLoad.toFixed(1)}A / ${transformer.type.maxCurrent}A
                            <br>
                            <strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¢Ù…Ù†Ø©:</strong> ${transformer.utilizationPercent.toFixed(1)}% (Ù…Ù† ${transformer.type.safeMaxCurrent}A)
                            <br>
                            <strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙØ¹Ù„ÙŠØ©:</strong> ${transformer.actualUtilizationPercent.toFixed(1)}% (Ù…Ù† ${transformer.type.maxCurrent}A)
                            <br>
                            <strong>Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</strong> ${usedBreakers.length} Ù…Ù† ${transformer.type.breakers}
                            <br>
                            <strong>Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯:</strong> ${transformer.overloadedBreakers}
                        </div>
                        ${transformer.utilizationPercent > 100 ? `
                            <div class="alert alert-warning">
                                âš ï¸ ØªØ­Ø°ÙŠØ±: Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ÙˆÙ„ Ù…Ø­Ù…Ù„ Ø²Ø§Ø¦Ø¯ Ø¹Ù† Ø·Ø§Ù‚ØªÙ‡ Ø§Ù„Ø¢Ù…Ù†Ø©!
                            </div>
                        ` : ''}
                        <div class="breaker-grid">
                            ${usedBreakers.map(breaker => `
                                <div class="breaker-card">
                                    <h4>âš¡ Ø§Ù„Ù‚Ø§Ø·Ø¹ ${breaker.number} ${getBreakerStatus(breaker.utilizationPercent)}</h4>
                                    <div><strong>Ø§Ù„Ø­Ù…Ù„:</strong> ${breaker.currentLoad.toFixed(1)}A / ${MAX_BREAKER_CAPACITY}A</div>
                                    <div class="progress-bar">
                                        <div class="progress-fill ${getProgressClass(breaker.utilizationPercent)}" 
                                             style="width: ${Math.min(breaker.utilizationPercent, 100)}%"></div>
                                    </div>
                                    <div><strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</strong> ${breaker.utilizationPercent.toFixed(1)}%</div>
                                    <div><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª:</strong> ${breaker.meters.length}</div>
                                    <div><strong>Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø­Ù…Ø§Ù„:</strong> ${Array.from(breaker.meterTypes).map(type => meterTypeNames[type]).join(', ')}</div>
                                    <div><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${getBreakerStatusText(breaker.status)}</div>
                                    <div style="margin-top: 10px;">
                                        <strong>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª:</strong><br>
                                        ${generateMeterDetailsHTML(breaker)}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getTransformerStatus(utilization) {
            if (utilization <= 70) {
                return '<span style="background: #4caf50; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">Ù…Ù…ØªØ§Ø²</span>';
            } else if (utilization <= 85) {
                return '<span style="background: #8bc34a; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">Ø¬ÙŠØ¯</span>';
            } else if (utilization <= 100) {
                return '<span style="background: #ff9800; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">Ù…Ù‚Ø¨ÙˆÙ„</span>';
            } else {
                return '<span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">Ù…Ø­Ù…Ù„ Ø²Ø§Ø¦Ø¯</span>';
            }
        }

        function getBreakerStatus(utilization) {
            if (utilization <= 70) {
                return '<span style="background: #4caf50; color: white; padding: 2px 6px; border-radius: 4px; font-size: 11px;">Ø¬ÙŠØ¯</span>';
            } else if (utilization <= 90) {
                return '<span style="background: #ff9800; color: white; padding: 2px 6px; border-radius: 4px; font-size: 11px;">Ù…Ù‚Ø¨ÙˆÙ„</span>';
            } else if (utilization <= 100) {
                return '<span style="background: #f44336; color: white; padding: 2px 6px; border-radius: 4px; font-size: 11px;">Ø¹Ø§Ù„ÙŠ</span>';
            } else {
                return '<span style="background: #ff5722; color: white; padding: 2px 6px; border-radius: 4px; font-size: 11px;">Ù…Ø­Ù…Ù„ Ø²Ø§Ø¦Ø¯</span>';
            }
        }

        function getBreakerStatusText(status) {
            const statusMap = {
                'available': 'Ù…ØªØ§Ø­',
                'in_use': 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…',
                'near_full': 'Ø´Ø¨Ù‡ Ù…Ù…ØªÙ„Ø¦',
                'overloaded': 'Ù…Ø­Ù…Ù„ Ø²Ø§Ø¦Ø¯'
            };
            return statusMap[status] || status;
        }

        function getProgressClass(utilization) {
            if (utilization <= 70) return 'progress-low';
            if (utilization <= 90) return 'progress-medium';
            if (utilization <= 100) return 'progress-high';
            return 'progress-overload';
        }

        function displayResultsTable(transformers) {
            const resultsBody = document.getElementById('resultsBody');
            
            let tableRows = '';
            
            transformers.forEach((transformer, transformerIndex) => {
                const usedBreakers = transformer.breakers.filter(b => b.meters.length > 0);
                usedBreakers.forEach(breaker => {
                    const meterTypes = Array.from(breaker.meterTypes).map(type => meterTypeNames[type]).join(', ');
                    const status = getBreakerStatusText(breaker.status);
                    const rowClass = breaker.utilizationPercent > 100 ? 'overloaded' : '';
                    
                    tableRows += `
                        <tr class="${rowClass}">
                            <td>Ø§Ù„Ù…Ø­ÙˆÙ„ ${transformerIndex + 1}<br><small>${transformer.type.name}</small></td>
                            <td>Ù‚Ø§Ø·Ø¹ ${breaker.number}</td>
                            <td>${meterTypes}</td>
                            <td>${breaker.meters.length}</td>
                            <td>${breaker.currentLoad.toFixed(1)}A</td>
                            <td>${breaker.utilizationPercent.toFixed(1)}%</td>
                            <td>${status}</td>
                            <td class="meter-details-cell">${generateMeterDetailsHTML(breaker)}</td>
                        </tr>
                    `;
                });
            });
            
            resultsBody.innerHTML = tableRows;
        }

        function generateMeterDetailsHTML(breaker) {
            const meterGroups = {};
            
            breaker.meters.forEach(meter => {
                const key = `${meter.type}_${meter.capacity}`;
                if (!meterGroups[key]) {
                    meterGroups[key] = {
                        type: meter.type,
                        typeName: meter.typeName,
                        capacity: meter.capacity,
                        count: 0,
                        totalCDL: 0
                    };
                }
                meterGroups[key].count++;
                meterGroups[key].totalCDL += meter.cdl;
            });

            return Object.values(meterGroups).map(group => {
                return `
                    <div class="meter-detail-item">
                        <span class="count">${group.count}</span>
                        <span class="multiply">Ã—</span>
                        <span class="capacity">${group.capacity}A</span>
                        <br>
                        <small>${group.typeName}</small>
                    </div>
                `;
            }).join('');
        }

        function exportToExcel() {
            if (!distributionResults) {
                showError('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„ØªØµØ¯ÙŠØ±');
                return;
            }
            
            let csvContent = "Ø§Ù„Ù…Ø­ÙˆÙ„,Ø§Ù„Ù‚Ø§Ø·Ø¹,Ù†ÙˆØ¹ Ø§Ù„Ø£Ø­Ù…Ø§Ù„,Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª,Ø§Ù„Ø­Ù…Ù„ Ø§Ù„ØªØ²Ø§Ù…Ù†ÙŠ (A),Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… (%),Ø§Ù„Ø­Ø§Ù„Ø©,ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª\n";
            
            distributionResults.transformers.forEach((transformer, transformerIndex) => {
                const usedBreakers = transformer.breakers.filter(b => b.meters.length > 0);
                usedBreakers.forEach(breaker => {
                    const meterTypes = Array.from(breaker.meterTypes).map(type => meterTypeNames[type]).join(' + ');
                    const status = getBreakerStatusText(breaker.status);
                    const meterDetails = breaker.meters.map(meter => 
                        `${meter.typeName} (${meter.capacity}A)`
                    ).join(' | ');
                    
                    csvContent += `"Ø§Ù„Ù…Ø­ÙˆÙ„ ${transformerIndex + 1} - ${transformer.type.name}",Ù‚Ø§Ø·Ø¹ ${breaker.number},"${meterTypes}",${breaker.meters.length},${breaker.currentLoad.toFixed(1)},${breaker.utilizationPercent.toFixed(1)},"${status}","${meterDetails}"\n`;
                });
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø®Øµ
            csvContent += `\nÙ…Ù„Ø®Øµ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ:\n`;
            csvContent += `Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª,${distributionResults.summary.totalTransformers}\n`;
            csvContent += `Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©,${distributionResults.summary.usedBreakers}\n`;            csvContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª,${distributionResults.summary.totalMeters}\n`;
            csvContent += `Ù…Ø­ÙˆÙ„Ø§Øª Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯,${distributionResults.summary.overloadedTransformers}\n`;
            csvContent += `Ù‚ÙˆØ§Ø·Ø¹ Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯,${distributionResults.summary.overloadedBreakers}\n`;
            csvContent += `ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…,${distributionResults.summary.efficiency}%\n`;
            csvContent += `Ù…ØªÙˆØ³Ø· Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹,${distributionResults.summary.avgBreakerUtilization}%\n`;
            csvContent += `Ø£Ù‚ØµÙ‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù‚ÙˆØ§Ø·Ø¹,${distributionResults.summary.maxBreakerUtilization}%\n`;
            csvContent += `Ø£Ø¯Ù†Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù‚ÙˆØ§Ø·Ø¹,${distributionResults.summary.minBreakerUtilization}%\n`;
            
            // Ø¥Ø¶Ø§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª
            csvContent += `\nØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª:\n`;
            csvContent += `Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙˆÙ„,Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ÙˆÙ„,Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (A),Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¢Ù…Ù†Ø© (%),Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙØ¹Ù„ÙŠØ© (%),Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©,Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯\n`;
            
            distributionResults.transformers.forEach((transformer, index) => {
                const usedBreakers = transformer.breakers.filter(b => b.meters.length > 0).length;
                csvContent += `${index + 1},${transformer.type.name},${transformer.totalLoad.toFixed(1)},${transformer.utilizationPercent.toFixed(1)},${transformer.actualUtilizationPercent.toFixed(1)},${usedBreakers},${transformer.overloadedBreakers}\n`;
            });
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `Ø§Ù„ØªÙˆØ²ÙŠØ¹_Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ_Ø§Ù„Ù…Ø­Ø³Ù†_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showSuccess('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ù†Ø¬Ø§Ø­');
        }

        function printResults() {
            if (!distributionResults) {
                showError('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©');
                return;
            }
            
            const printWindow = window.open('', '_blank');
            const printContent = `
                <!DOCTYPE html>
                <html dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <title>ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø§Ù„Ù…Ø­Ø³Ù† Ù„Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1, h2, h3 { color: #333; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
                        th { background-color: #4facfe; color: white; }
                        .overloaded { background-color: #ffebee; }
                        .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin: 20px 0; }
                        .stat-card { border: 2px solid #4facfe; padding: 15px; text-align: center; border-radius: 8px; }
                        .transformer-summary { background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 8px; }
                        .warning { background-color: #fff3cd; border: 1px solid #ffc107; color: #856404; padding: 10px; border-radius: 4px; margin: 10px 0; }
                        .statistics-section { background: #f0f8ff; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #4facfe; }
                        .success { background-color: #d4edda; border: 1px solid #c3e6cb; color: #155724; padding: 10px; border-radius: 4px; margin: 10px 0; }
                    </style>
                </head>
                <body>
                    <h1>ğŸ“‹ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø§Ù„Ù…Ø­Ø³Ù† Ù„Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª</h1>
                    <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±:</strong> ${new Date().toLocaleDateString('ar-SA')}</p>
                    <p><strong>ÙˆÙ‚Øª Ø§Ù„ØªÙ‚Ø±ÙŠØ±:</strong> ${new Date().toLocaleTimeString('ar-SA')}</p>
                    <p><strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆØ²ÙŠØ¹:</strong> ØªØ³Ù„Ø³Ù„ÙŠ Ù…Ø­Ø³Ù† Ø­Ø³Ø¨ Ø§Ù„Ø£Ø­Ù…Ø§Ù„ Ø§Ù„ØªØ²Ø§Ù…Ù†ÙŠØ© - 248A Ø­Ø¯ Ø£Ù‚ØµÙ‰ Ù„ÙƒÙ„ Ù‚Ø§Ø·Ø¹</p>
                    
                    <h2>ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h2>
                    <div class="summary">
                        <div class="stat-card">
                            <h3>${distributionResults.summary.totalTransformers}</h3>
                            <p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª</p>
                        </div>
                        <div class="stat-card">
                            <h3>${distributionResults.summary.usedBreakers}</h3>
                            <p>Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©</p>
                        </div>
                        <div class="stat-card">
                            <h3>${distributionResults.summary.totalMeters}</h3>
                            <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª</p>
                        </div>
                        <div class="stat-card">
                            <h3>${distributionResults.summary.efficiency}%</h3>
                            <p>ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</p>
                        </div>
                    </div>
                    
                    <div class="statistics-section">
                        <h3>ğŸ“ˆ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙˆØ²ÙŠØ¹</h3>
                        <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ù…Ù„:</strong> ${distributionResults.summary.totalLoad}A</p>
                        <p><strong>Ù…ØªÙˆØ³Ø· Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹:</strong> ${distributionResults.summary.avgBreakerUtilization}%</p>
                        <p><strong>Ø£Ù‚ØµÙ‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù‚ÙˆØ§Ø·Ø¹:</strong> ${distributionResults.summary.maxBreakerUtilization}%</p>
                        <p><strong>Ø£Ø¯Ù†Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù‚ÙˆØ§Ø·Ø¹:</strong> ${distributionResults.summary.minBreakerUtilization}%</p>
                        <p><strong>Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯:</strong> ${distributionResults.summary.overloadedTransformers}</p>
                        <p><strong>Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯:</strong> ${distributionResults.summary.overloadedBreakers}</p>
                    </div>
                    
                    ${distributionResults.summary.overloadedTransformers === 0 && distributionResults.summary.overloadedBreakers === 0 ? 
                        '<div class="success">âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª ÙˆØ§Ù„Ù‚ÙˆØ§Ø·Ø¹ ØªØ¹Ù…Ù„ Ø¶Ù…Ù† Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¢Ù…Ù†Ø©</div>' : 
                        '<div class="warning">âš ï¸ ÙŠÙˆØ¬Ø¯ Ù…Ø­ÙˆÙ„Ø§Øª Ø£Ùˆ Ù‚ÙˆØ§Ø·Ø¹ Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯ - ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙˆØ²ÙŠØ¹</div>'
                    }
                    
                    <h2>ğŸ”Œ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª</h2>
                    ${distributionResults.transformers.map((transformer, index) => {
                        const isOverloaded = transformer.utilizationPercent > 100;
                        const usedBreakers = transformer.breakers.filter(b => b.meters.length > 0).length;
                        const statusClass = isOverloaded ? 'warning' : 'success';
                        return `
                            <div class="transformer-summary">
                                <h3>Ø§Ù„Ù…Ø­ÙˆÙ„ ${index + 1}: ${transformer.type.name}</h3>
                                <div class="${statusClass}">
                                    <strong>Ø§Ù„Ø­Ù…Ù„:</strong> ${transformer.totalLoad.toFixed(1)}A / ${transformer.type.maxCurrent}A<br>
                                    <strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¢Ù…Ù†Ø©:</strong> ${transformer.utilizationPercent.toFixed(1)}% (Ù…Ù† ${transformer.type.safeMaxCurrent}A)<br>
                                    <strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙØ¹Ù„ÙŠØ©:</strong> ${transformer.actualUtilizationPercent.toFixed(1)}% (Ù…Ù† ${transformer.type.maxCurrent}A)<br>
                                    <strong>Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</strong> ${usedBreakers} Ù…Ù† ${transformer.type.breakers}<br>
                                    <strong>Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹ Ø§Ù„Ù…Ø­Ù…Ù„Ø© Ø²Ø§Ø¦Ø¯:</strong> ${transformer.overloadedBreakers}<br>
                                    <strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${isOverloaded ? 'âš ï¸ Ù…Ø­Ù…Ù„ Ø²Ø§Ø¦Ø¯' : 'âœ… Ø¶Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø¢Ù…Ù†'}
                                </div>
                                
                                <h4>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ø·Ø¹:</h4>
                                ${transformer.breakers.filter(b => b.meters.length > 0).map(breaker => `
                                    <div style="margin: 10px 0; padding: 10px; background: ${breaker.utilizationPercent > 100 ? '#ffebee' : '#f8f9fa'}; border-radius: 4px;">
                                        <strong>Ø§Ù„Ù‚Ø§Ø·Ø¹ ${breaker.number}:</strong> ${breaker.currentLoad.toFixed(1)}A (${breaker.utilizationPercent.toFixed(1)}%) - ${breaker.meters.length} Ø¹Ø¯Ø§Ø¯<br>
                                        <small>Ø§Ù„Ø£Ø­Ù…Ø§Ù„: ${Array.from(breaker.meterTypes).map(type => meterTypeNames[type]).join(', ')}</small>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    }).join('')}
                    
                    <h2>ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</h2>
                    ${document.getElementById('resultsTable').outerHTML}
                    
                    <div style="margin-top: 30px; padding: 15px; background: #e3f2fd; border-radius: 8px;">
                        <h3>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©:</h3>
                        <ul>
                            <li><strong>Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„ØªÙˆØ²ÙŠØ¹:</strong> ØªØ³Ù„Ø³Ù„ÙŠ Ù…Ø­Ø³Ù† Ù…Ø¹ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ÙˆÙ„Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</li>
                            <li><strong>ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª:</strong> Ø­Ø³Ø¨ Ø§Ù„Ø­Ù…Ù„ (Ø§Ù„Ø£ÙƒØ¨Ø± Ø£ÙˆÙ„Ø§Ù‹) Ù„Ø¶Ù…Ø§Ù† ØªÙˆØ²ÙŠØ¹ Ø£Ù…Ø«Ù„</li>
                            <li><strong>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ù‚Ø§Ø·Ø¹:</strong> 248 Ø£Ù…Ø¨ÙŠØ±</li>
                            <li><strong>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø¢Ù…Ù† Ù„Ù„Ù…Ø­ÙˆÙ„:</strong> 80% Ù…Ù† Ø§Ù„Ø³Ø¹Ø© Ø§Ù„Ù‚ØµÙˆÙ‰</li>
                            <li><strong>Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ÙˆÙ„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©:</strong> ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù…ØªÙ„Ø§Ø¡ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ</li>
                            <li><strong>Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ÙˆÙ„:</strong> Ø­Ø³Ø¨ Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ÙƒÙØ§Ø¡Ø©</li>
                        </ul>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: #f1f8e9; border-radius: 8px;">
                        <h3>Ù…Ø²Ø§ÙŠØ§ Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†Ø©:</h3>
                        <ul>
                            <li>âœ… <strong>ØªÙˆØ²ÙŠØ¹ Ø°ÙƒÙŠ:</strong> ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ù…Ù„</li>
                            <li>âœ… <strong>Ø¥Ù†Ø´Ø§Ø¡ ØªÙ„Ù‚Ø§Ø¦ÙŠ:</strong> Ù„Ù„Ù…Ø­ÙˆÙ„Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©</li>
                            <li>âœ… <strong>Ø§Ø®ØªÙŠØ§Ø± Ø£Ù…Ø«Ù„:</strong> Ù„Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø­Ø³Ø¨ Ø§Ù„Ø­Ù…Ù„</li>
                            <li>âœ… <strong>Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø¯:</strong> Ø§Ø­ØªØ±Ø§Ù… Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¢Ù…Ù†Ø©</li>
                            <li>âœ… <strong>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø´Ø§Ù…Ù„Ø©:</strong> Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡</li>
                            <li>âœ… <strong>ØªØªØ¨Ø¹ Ø¯Ù‚ÙŠÙ‚:</strong> Ù„Ø­Ø§Ù„Ø© ÙƒÙ„ Ù‚Ø§Ø·Ø¹ ÙˆÙ…Ø­ÙˆÙ„</li>
                        </ul>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: #fff3e0; border-radius: 8px;">
                        <h3>Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©:</h3>
                        <ul>
                            <li><strong>Ù‚Ø§Ø·Ø¹ 248A:</strong> Ø­Ø¯ Ø£Ù‚ØµÙ‰ Ù„ÙƒÙ„ Ù‚Ø§Ø·Ø¹</li>
                            <li><strong>Ù…Ø­ÙˆÙ„ 500KVA:</strong> Ø­Ø¯ Ø¢Ù…Ù† 577A (80% Ù…Ù† 721A)</li>
                            <li><strong>Ù…Ø­ÙˆÙ„ 1000KVA:</strong> Ø­Ø¯ Ø¢Ù…Ù† 1154A (80% Ù…Ù† 1443A)</li>
                            <li><strong>Ù…Ø­ÙˆÙ„ 1500KVA:</strong> Ø­Ø¯ Ø¢Ù…Ù† 1731A (80% Ù…Ù† 2164A)</li>
                        </ul>
                    </div>
                    
                    <div style="margin-top: 30px; text-align: center; color: #666; border-top: 2px solid #4facfe; padding-top: 15px;">
                        <p><strong>ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø§Ù„Ù…Ø­Ø³Ù†</strong></p>
                        <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ØªÙ…Øª ÙˆÙÙ‚Ø§Ù‹ Ù„Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</p>
                    </div>
                </body>
                </html>
            `;
            
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
            
            showSuccess('ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©');
        }

        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'alert alert-error';
            errorDiv.innerHTML = `âš ï¸ ${message}`;
            errorDiv.style.position = 'fixed';
            errorDiv.style.top = '20px';
            errorDiv.style.right = '20px';
            errorDiv.style.zIndex = '9999';
            errorDiv.style.maxWidth = '400px';
            errorDiv.style.borderRadius = '8px';
            errorDiv.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
            
            document.body.appendChild(errorDiv);
            
            setTimeout(() => {
                if (document.body.contains(errorDiv)) {
                    document.body.removeChild(errorDiv);
                }
            }, 5000);
        }

        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'alert alert-success';
            successDiv.innerHTML = `âœ… ${message}`;
            successDiv.style.position = 'fixed';
            successDiv.style.top = '20px';
            successDiv.style.right = '20px';
            successDiv.style.zIndex = '9999';
            successDiv.style.maxWidth = '400px';
            successDiv.style.borderRadius = '8px';
            successDiv.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                if (document.body.contains(successDiv)) {
                    document.body.removeChild(successDiv);
                }
            }, 3000);
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            updateMetersList();
            
            document.getElementById('meterCount').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addMeter();
                }
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
            console.log('ğŸ”§ Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø§Ù„Ù…Ø­Ø³Ù† Ø¬Ø§Ù‡Ø²');
            console.log('ğŸ“‹ Ø§Ù„Ù…Ø²Ø§ÙŠØ§ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:');
            console.log('   âœ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ÙˆÙ„Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©');
            console.log('   âœ… Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø£Ù…Ø«Ù„ Ø­Ø³Ø¨ Ø§Ù„Ø­Ù…Ù„');
            console.log('   âœ… Ø§Ø­ØªØ±Ø§Ù… Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¢Ù…Ù†Ø© Ù„Ù„Ù…Ø­ÙˆÙ„Ø§Øª');
            console.log('   âœ… ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ù…Ù„');
            console.log('   âœ… Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠØ©');
            console.log('   âœ… Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø´Ø§Ù…Ù„Ø© ÙˆÙ…ÙØµÙ„Ø©');
        });
    </script>
</body>
</html>

            
